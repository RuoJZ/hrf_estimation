TODO: provide fallback for einsum